## :soccer: Football Match Prediction Project with MLP :soccer:

###  2020.02 해외축구 승부예측
&nbsp;&nbsp; 전 세계적으로 많은 관심을 받는 해외축구. 과거 경기 데이터를 활용하여 __앞으로 있을 경기의 승부를 예측__ 하는 것이 목표입니다. <br>
6대리그 중 러시아를 제외한 영국,스페인,이탈리아,독일,프랑스의 1부 리그 경기 결과를 크롤링하여 미래에 있을 경기를 예측하는 모델을 만든다면, 스포츠토토를 즐기는 사람들의 픽에 도움을 줄 수 있고 높은 성능을 보일시 상업적으로도 사용할 수 있을 것입니다.

<br>

## :bulb: 전체적인 분석 목표
  - **무승부**
    + 해외축구의 승부예측의 핵심은 **무승부**라고 할 수 있습니다. 스포츠토토를 즐기는 사람들 사이에서는 일명 "무잡이"라고 불리는 사람들이 있을 정도로 무승부를 맞추는 것은 어려운 일이며 따라서 배당도 그만큼 높습니다. 승패 뿐만 아니라 무승부를 예측하는 모델을 만드는 것을 목표로 합니다. <br>
  - 다양한 머신러닝 기법 (XGB, RF, MLP) 등을 활용하여 가장 좋은 성능을 보이는 기법을 활용합니다.

<br>

## :file_folder: 파일 구조
```
├── Football_predict_Project/
   ├── Crawling1.py
   ├── Crawling2.py
   ├── Pr+eprocessing1.R
   ├── Preprocessing2.R
   └── Modeling.R
```
 - `Crawling1.py` 해외축구 경기 결과를 제공하는 Fivethirtyeight 사이트의 경기결과 값과 예측값을 크롤링 하는 파일입니다.
 - `Crawling2.py` 해외축구 경기 결과를 제공하는 Understat 사이트의 경기결과 값, 선수기록, 슈팅기록 등의 값을 크롤링 하는 파일입니다.
 - `Pr+eprocessing1.R` 데이터분석 전 데이터를 정리하는 파일입니다. 각 데이터를 합치고 결측치 대체와 각 리그별 이름을 영어로 통일시키는 등의 전처리 파일입니다.
 - `Preprocessing2.R` 미래 경기를 예측하므로, 각 결과를 Lag하는 등의 Feature Engineering을 진행하는 파일입니다.
 - `Modeling.R` 전처리를 한 최종데이터를 활용하여 모델링하는 파일입니다.
 
 <br>
 
## :bulb: 분석과정
### 0. Python을 활용한 데이터 크롤링
 * fivethirtyeight의 경우 주소를 활용하여 크롤링합니다. <br>
 * understat의 경우 제공되는 모듈을 활용하여 크롤링을 진행합니다. <br>
 
### 1. 분석 과정 및 데이터 특성상 나타나는 문제
#### &nbsp;&nbsp;  1-1. 실제 미래의 경기를 예측<br>
&nbsp;&nbsp;&nbsp;&nbsp; 현재 분석에 활용되는 데이터는 이미 경기가 치뤄진 뒤의 데이터이므로 미래의 승부를 예측할 때는 해당 데이터의 값은 존재하지 않으므로 모델의 Input으로 사용할 수 없습니다. 따라서 데이터를 Lag하여 최근 O회 평균 등의 값으로 변수를 변환시켜주어야 하며 최근 몇회까지 반영하느냐에 따라서도 많은 변화가 생길 수 있습니다.
 
 
 #### &nbsp;&nbsp; 1-2. 무승부 예측<br>
 &nbsp;&nbsp;&nbsp;&nbsp; 본 데이터는 무승부 수가 비교적 적은 Imbalance한 데이터입니다. 또한 이를 Sampling하여 balance하게 맞춰준다고 해도 무승부가 나는 경기의 특성을 잡아내는 것은 상당히 어렵습니다. 따라서, 모델링 과정에서 단순히 MultiClass Classification을 진행하는 것이 아닌 HOME팀의 승리인지 아닌지, AWAY팀의 승리인지 아닌지를 예측하여 HOME팀의 승리가 아니고 AWAY팀의 승리도 아닌 경우를 무승부로 예측하는 알고리즘을 생성하였습니다. 또한 단순히 SoftMax를 활용하는 것이 아닌 SoftProb를 이용하여 최적의 Threshold를 찾는 과정을 거쳐 약 53~54% 정도의 Accuracy를 보이는 모델을 구축했습니다.
 
<br>

  ## :disappointed: 아쉬운점
  - 유의한 변수를 찾기가 상당히 어려워 모델의 성능을 높이는데 어려움이 있었습니다. <br>
  - 해당 경기의 날씨, 리그컵, 친선경기 등 다른 모든 경기에 대한 정보가 있었다면 선수의 피로도 등을 반영할 수 있을 것입니다.  <br>
  - 경기 전 사람들의 의견등을 비정형데이터로 활용할 수 있다면 좋은 feature가 될 수 있을것으로 예상됩니다. <br>
